... loading data
... building the model
... getting the pretraining functions
... pre-training the model
Pre-training layer 0, epoch 0, cost  -16.2983139069
Pre-training layer 0, epoch 1, cost  -15.3487384449
Pre-training layer 0, epoch 2, cost  -14.5377407341
Pre-training layer 0, epoch 3, cost  -13.7771575652
Pre-training layer 0, epoch 4, cost  -13.1719033635
Pre-training layer 0, epoch 5, cost  -12.5828647349
Pre-training layer 0, epoch 6, cost  -12.1675609825
Pre-training layer 0, epoch 7, cost  -11.7209444466
Pre-training layer 0, epoch 8, cost  -11.3312052367
Pre-training layer 0, epoch 9, cost  -11.0632140421
Pre-training layer 0, epoch 10, cost  -10.7616923136
Pre-training layer 0, epoch 11, cost  -10.5383178348
Pre-training layer 0, epoch 12, cost  -10.3049881775
Pre-training layer 0, epoch 13, cost  -10.130886294
Pre-training layer 0, epoch 14, cost  -9.99384846058
Pre-training layer 0, epoch 15, cost  -9.8568378763
Pre-training layer 0, epoch 16, cost  -9.76153807233
Pre-training layer 0, epoch 17, cost  -9.65548997224
Pre-training layer 0, epoch 18, cost  -9.57914475502
Pre-training layer 0, epoch 19, cost  -9.52950607093
Pre-training layer 0, epoch 20, cost  -9.44533429672
Pre-training layer 0, epoch 21, cost  -9.42863911519
Pre-training layer 0, epoch 22, cost  -9.37033004546
Pre-training layer 0, epoch 23, cost  -9.34232839797
Pre-training layer 0, epoch 24, cost  -9.30751827076
Pre-training layer 0, epoch 25, cost  -9.30549076539
Pre-training layer 0, epoch 26, cost  -9.26378374152
Pre-training layer 0, epoch 27, cost  -9.25648207101
Pre-training layer 0, epoch 28, cost  -9.23512275129
Pre-training layer 0, epoch 29, cost  -9.23651973129
Pre-training layer 0, epoch 30, cost  -9.24444549176
Pre-training layer 0, epoch 31, cost  -9.21789521697
Pre-training layer 0, epoch 32, cost  -9.21794594236
Pre-training layer 0, epoch 33, cost  -9.22546959532
Pre-training layer 0, epoch 34, cost  -9.18728386067
Pre-training layer 0, epoch 35, cost  -9.18041155242
Pre-training layer 0, epoch 36, cost  -9.22228221029
Pre-training layer 0, epoch 37, cost  -9.20923745042
Pre-training layer 0, epoch 38, cost  -9.1991491777
Pre-training layer 0, epoch 39, cost  -9.19900274349
Pre-training layer 0, epoch 40, cost  -9.18894265175
Pre-training layer 0, epoch 41, cost  -9.17695145285
Pre-training layer 0, epoch 42, cost  -9.18434507846
Pre-training layer 0, epoch 43, cost  -9.18341494417
Pre-training layer 0, epoch 44, cost  -9.18649248919
Pre-training layer 0, epoch 45, cost  -9.1839156573
Pre-training layer 0, epoch 46, cost  -9.18485857104
Pre-training layer 0, epoch 47, cost  -9.18180290136
Pre-training layer 0, epoch 48, cost  -9.17450251332
Pre-training layer 0, epoch 49, cost  -9.15877875513
Pre-training layer 0, epoch 50, cost  -9.18669509958
Pre-training layer 0, epoch 51, cost  -9.17775615932
Pre-training layer 0, epoch 52, cost  -9.17038976044
Pre-training layer 0, epoch 53, cost  -9.16236983159
Pre-training layer 0, epoch 54, cost  -9.20395793046
Pre-training layer 0, epoch 55, cost  -9.16775937643
Pre-training layer 0, epoch 56, cost  -9.17053164367
Pre-training layer 0, epoch 57, cost  -9.18768548147
Pre-training layer 0, epoch 58, cost  -9.19877990979
Pre-training layer 0, epoch 59, cost  -9.16915447592
Pre-training layer 0, epoch 60, cost  -9.17472346852
Pre-training layer 0, epoch 61, cost  -9.18950668262
Pre-training layer 0, epoch 62, cost  -9.16943053681
Pre-training layer 0, epoch 63, cost  -9.18087070885
Pre-training layer 0, epoch 64, cost  -9.17314943555
Pre-training layer 0, epoch 65, cost  -9.18635486679
Pre-training layer 0, epoch 66, cost  -9.1736584002
Pre-training layer 0, epoch 67, cost  -9.17731078639
Pre-training layer 0, epoch 68, cost  -9.18400693568
Pre-training layer 0, epoch 69, cost  -9.17928974655
Pre-training layer 0, epoch 70, cost  -9.19290568562
Pre-training layer 0, epoch 71, cost  -9.17473593269
Pre-training layer 0, epoch 72, cost  -9.20467398688
Pre-training layer 0, epoch 73, cost  -9.19005717221
Pre-training layer 0, epoch 74, cost  -9.14892312201
Pre-training layer 0, epoch 75, cost  -9.18202965666
Pre-training layer 0, epoch 76, cost  -9.1578314681
Pre-training layer 0, epoch 77, cost  -9.18750308033
Pre-training layer 0, epoch 78, cost  -9.17084299664
Pre-training layer 0, epoch 79, cost  -9.19061819809
Pre-training layer 0, epoch 80, cost  -9.1694677333
Pre-training layer 0, epoch 81, cost  -9.1851912815
Pre-training layer 0, epoch 82, cost  -9.16356514404
Pre-training layer 0, epoch 83, cost  -9.17795550887
Pre-training layer 0, epoch 84, cost  -9.20029389372
Pre-training layer 0, epoch 85, cost  -9.17267196316
Pre-training layer 0, epoch 86, cost  -9.17016789823
Pre-training layer 0, epoch 87, cost  -9.19598254696
Pre-training layer 0, epoch 88, cost  -9.16504167709
Pre-training layer 0, epoch 89, cost  -9.16817302973
Pre-training layer 0, epoch 90, cost  -9.16559526125
Pre-training layer 0, epoch 91, cost  -9.17891537138
Pre-training layer 0, epoch 92, cost  -9.13994246606
Pre-training layer 0, epoch 93, cost  -9.18910601107
Pre-training layer 0, epoch 94, cost  -9.16633436063
Pre-training layer 0, epoch 95, cost  -9.18153609985
Pre-training layer 0, epoch 96, cost  -9.17085440765
Pre-training layer 0, epoch 97, cost  -9.16815008707
Pre-training layer 0, epoch 98, cost  -9.15255854179
Pre-training layer 0, epoch 99, cost  -9.16189601004
Pre-training layer 1, epoch 0, cost  -747.576197068
Pre-training layer 1, epoch 1, cost  -711.526704508
Pre-training layer 1, epoch 2, cost  -706.147406831
Pre-training layer 1, epoch 3, cost  -703.344382407
Pre-training layer 1, epoch 4, cost  -701.683535131
Pre-training layer 1, epoch 5, cost  -700.700509485
Pre-training layer 1, epoch 6, cost  -699.940172572
Pre-training layer 1, epoch 7, cost  -699.405464385
Pre-training layer 1, epoch 8, cost  -699.192395026
Pre-training layer 1, epoch 9, cost  -698.853962715
Pre-training layer 1, epoch 10, cost  -698.731437061
Pre-training layer 1, epoch 11, cost  -698.611150823
Pre-training layer 1, epoch 12, cost  -698.446772424
Pre-training layer 1, epoch 13, cost  -698.35674266
Pre-training layer 1, epoch 14, cost  -698.331055878
Pre-training layer 1, epoch 15, cost  -698.18170561
Pre-training layer 1, epoch 16, cost  -698.132923127
Pre-training layer 1, epoch 17, cost  -698.082333166
Pre-training layer 1, epoch 18, cost  -698.07313482
Pre-training layer 1, epoch 19, cost  -698.069520011
Pre-training layer 1, epoch 20, cost  -698.0354585
Pre-training layer 1, epoch 21, cost  -698.0352251
Pre-training layer 1, epoch 22, cost  -698.021977804
Pre-training layer 1, epoch 23, cost  -698.024182958
Pre-training layer 1, epoch 24, cost  -697.95926363
Pre-training layer 1, epoch 25, cost  -697.900486567
Pre-training layer 1, epoch 26, cost  -698.01090198
Pre-training layer 1, epoch 27, cost  -697.886474063
Pre-training layer 1, epoch 28, cost  -697.891979159
Pre-training layer 1, epoch 29, cost  -697.920090117
Pre-training layer 1, epoch 30, cost  -697.873775808
Pre-training layer 1, epoch 31, cost  -697.886279846
Pre-training layer 1, epoch 32, cost  -697.842344648
Pre-training layer 1, epoch 33, cost  -697.817355931
Pre-training layer 1, epoch 34, cost  -697.85506102
Pre-training layer 1, epoch 35, cost  -697.844601763
Pre-training layer 1, epoch 36, cost  -697.749659748
Pre-training layer 1, epoch 37, cost  -697.783679558
Pre-training layer 1, epoch 38, cost  -697.827817452
Pre-training layer 1, epoch 39, cost  -697.821873949
Pre-training layer 1, epoch 40, cost  -697.815592955
Pre-training layer 1, epoch 41, cost  -697.817177026
Pre-training layer 1, epoch 42, cost  -697.723365482
Pre-training layer 1, epoch 43, cost  -697.791738741
Pre-training layer 1, epoch 44, cost  -697.768004492
Pre-training layer 1, epoch 45, cost  -697.717659497
Pre-training layer 1, epoch 46, cost  -697.784013566
Pre-training layer 1, epoch 47, cost  -697.814030702
Pre-training layer 1, epoch 48, cost  -697.788258445
Pre-training layer 1, epoch 49, cost  -697.748117212
Pre-training layer 1, epoch 50, cost  -697.754813332
Pre-training layer 1, epoch 51, cost  -697.71947449
Pre-training layer 1, epoch 52, cost  -697.787637416
Pre-training layer 1, epoch 53, cost  -697.759621078
Pre-training layer 1, epoch 54, cost  -697.693011608
Pre-training layer 1, epoch 55, cost  -697.72098619
Pre-training layer 1, epoch 56, cost  -697.735656919
Pre-training layer 1, epoch 57, cost  -697.797300151
Pre-training layer 1, epoch 58, cost  -697.809124456
Pre-training layer 1, epoch 59, cost  -697.694965492
Pre-training layer 1, epoch 60, cost  -697.732308611
Pre-training layer 1, epoch 61, cost  -697.787993166
Pre-training layer 1, epoch 62, cost  -697.751703165
Pre-training layer 1, epoch 63, cost  -697.710530072
Pre-training layer 1, epoch 64, cost  -697.692701427
Pre-training layer 1, epoch 65, cost  -697.707823528
Pre-training layer 1, epoch 66, cost  -697.737700936
Pre-training layer 1, epoch 67, cost  -697.772233054
Pre-training layer 1, epoch 68, cost  -697.710919005
Pre-training layer 1, epoch 69, cost  -697.693081268
Pre-training layer 1, epoch 70, cost  -697.731163314
Pre-training layer 1, epoch 71, cost  -697.674260116
Pre-training layer 1, epoch 72, cost  -697.703913142
Pre-training layer 1, epoch 73, cost  -697.680307845
Pre-training layer 1, epoch 74, cost  -697.694778827
Pre-training layer 1, epoch 75, cost  -697.705947765
Pre-training layer 1, epoch 76, cost  -697.74483201
Pre-training layer 1, epoch 77, cost  -697.761108237
Pre-training layer 1, epoch 78, cost  -697.71516242
Pre-training layer 1, epoch 79, cost  -697.690343496
Pre-training layer 1, epoch 80, cost  -697.748380572
Pre-training layer 1, epoch 81, cost  -697.70510848
Pre-training layer 1, epoch 82, cost  -697.676693622
Pre-training layer 1, epoch 83, cost  -697.657710371
Pre-training layer 1, epoch 84, cost  -697.636702213
Pre-training layer 1, epoch 85, cost  -697.66903979
Pre-training layer 1, epoch 86, cost  -697.705683667
Pre-training layer 1, epoch 87, cost  -697.671798397
Pre-training layer 1, epoch 88, cost  -697.773322207
Pre-training layer 1, epoch 89, cost  -697.69047784
Pre-training layer 1, epoch 90, cost  -697.814078108
Pre-training layer 1, epoch 91, cost  -697.642067152
Pre-training layer 1, epoch 92, cost  -697.723454815
Pre-training layer 1, epoch 93, cost  -697.704004164
Pre-training layer 1, epoch 94, cost  -697.716017872
Pre-training layer 1, epoch 95, cost  -697.724667898
Pre-training layer 1, epoch 96, cost  -697.70279788
Pre-training layer 1, epoch 97, cost  -697.774512371
Pre-training layer 1, epoch 98, cost  -697.674503923
Pre-training layer 1, epoch 99, cost  -697.598275923
Pre-training layer 2, epoch 0, cost  -17.1721749364
Pre-training layer 2, epoch 1, cost  -2.59734918456
Pre-training layer 2, epoch 2, cost  -2.22722484993
Pre-training layer 2, epoch 3, cost  -1.98264617341
Pre-training layer 2, epoch 4, cost  -1.81491072036
Pre-training layer 2, epoch 5, cost  -1.69862758135
Pre-training layer 2, epoch 6, cost  -1.62196245973
Pre-training layer 2, epoch 7, cost  -1.56281414903
Pre-training layer 2, epoch 8, cost  -1.52398578016
Pre-training layer 2, epoch 9, cost  -1.49790835209
Pre-training layer 2, epoch 10, cost  -1.47442079057
Pre-training layer 2, epoch 11, cost  -1.46188718984
Pre-training layer 2, epoch 12, cost  -1.44674876455
Pre-training layer 2, epoch 13, cost  -1.43421532495
Pre-training layer 2, epoch 14, cost  -1.42674406801
Pre-training layer 2, epoch 15, cost  -1.41777322881
Pre-training layer 2, epoch 16, cost  -1.40906575591
Pre-training layer 2, epoch 17, cost  -1.40437300486
Pre-training layer 2, epoch 18, cost  -1.40593096683
Pre-training layer 2, epoch 19, cost  -1.40039584567
Pre-training layer 2, epoch 20, cost  -1.39637516944
Pre-training layer 2, epoch 21, cost  -1.38469178144
Pre-training layer 2, epoch 22, cost  -1.38436818019
Pre-training layer 2, epoch 23, cost  -1.38062077311
Pre-training layer 2, epoch 24, cost  -1.37914284023
Pre-training layer 2, epoch 25, cost  -1.37399859912
Pre-training layer 2, epoch 26, cost  -1.37167391531
Pre-training layer 2, epoch 27, cost  -1.37411895449
Pre-training layer 2, epoch 28, cost  -1.36969700559
Pre-training layer 2, epoch 29, cost  -1.37024564435
Pre-training layer 2, epoch 30, cost  -1.36830547687
Pre-training layer 2, epoch 31, cost  -1.37077566257
Pre-training layer 2, epoch 32, cost  -1.36407104337
Pre-training layer 2, epoch 33, cost  -1.36398982618
Pre-training layer 2, epoch 34, cost  -1.36128638216
Pre-training layer 2, epoch 35, cost  -1.36408282419
Pre-training layer 2, epoch 36, cost  -1.35985683269
Pre-training layer 2, epoch 37, cost  -1.35509089268
Pre-training layer 2, epoch 38, cost  -1.35188794012
Pre-training layer 2, epoch 39, cost  -1.35613910737
Pre-training layer 2, epoch 40, cost  -1.35157352882
Pre-training layer 2, epoch 41, cost  -1.35088506979
Pre-training layer 2, epoch 42, cost  -1.34676866014
Pre-training layer 2, epoch 43, cost  -1.34893858584
Pre-training layer 2, epoch 44, cost  -1.34901745487
Pre-training layer 2, epoch 45, cost  -1.34867169743
Pre-training layer 2, epoch 46, cost  -1.3492674468
Pre-training layer 2, epoch 47, cost  -1.34705881234
Pre-training layer 2, epoch 48, cost  -1.34336304094
Pre-training layer 2, epoch 49, cost  -1.34039158857
Pre-training layer 2, epoch 50, cost  -1.33770973637
Pre-training layer 2, epoch 51, cost  -1.33880001909
Pre-training layer 2, epoch 52, cost  -1.33943420126
Pre-training layer 2, epoch 53, cost  -1.33766788474
Pre-training layer 2, epoch 54, cost  -1.34103492166
Pre-training layer 2, epoch 55, cost  -1.3370757188
Pre-training layer 2, epoch 56, cost  -1.33474860581
Pre-training layer 2, epoch 57, cost  -1.33669845585
Pre-training layer 2, epoch 58, cost  -1.33299301905
Pre-training layer 2, epoch 59, cost  -1.33397471991
Pre-training layer 2, epoch 60, cost  -1.33329781793
Pre-training layer 2, epoch 61, cost  -1.33376224176
Pre-training layer 2, epoch 62, cost  -1.33546651022
Pre-training layer 2, epoch 63, cost  -1.33078408848
Pre-training layer 2, epoch 64, cost  -1.33154935684
Pre-training layer 2, epoch 65, cost  -1.32830328021
Pre-training layer 2, epoch 66, cost  -1.32425231072
Pre-training layer 2, epoch 67, cost  -1.32797319038
Pre-training layer 2, epoch 68, cost  -1.32923720457
Pre-training layer 2, epoch 69, cost  -1.32821175131
Pre-training layer 2, epoch 70, cost  -1.3239875284
Pre-training layer 2, epoch 71, cost  -1.32441577799
Pre-training layer 2, epoch 72, cost  -1.3277973108
Pre-training layer 2, epoch 73, cost  -1.32537309266
Pre-training layer 2, epoch 74, cost  -1.32411664465
Pre-training layer 2, epoch 75, cost  -1.32269154266
Pre-training layer 2, epoch 76, cost  -1.31918583973
Pre-training layer 2, epoch 77, cost  -1.32220508966
Pre-training layer 2, epoch 78, cost  -1.31999312233
Pre-training layer 2, epoch 79, cost  -1.32071469838
Pre-training layer 2, epoch 80, cost  -1.3206802964
Pre-training layer 2, epoch 81, cost  -1.31880356805
Pre-training layer 2, epoch 82, cost  -1.31870901092
Pre-training layer 2, epoch 83, cost  -1.31712258399
Pre-training layer 2, epoch 84, cost  -1.31410796331
Pre-training layer 2, epoch 85, cost  -1.31377628748
Pre-training layer 2, epoch 86, cost  -1.31575777633
Pre-training layer 2, epoch 87, cost  -1.31747968783
Pre-training layer 2, epoch 88, cost  -1.3170520206
Pre-training layer 2, epoch 89, cost  -1.31333021218
Pre-training layer 2, epoch 90, cost  -1.31200149856
Pre-training layer 2, epoch 91, cost  -1.31433772322
Pre-training layer 2, epoch 92, cost  -1.31570073749
Pre-training layer 2, epoch 93, cost  -1.30952111692
Pre-training layer 2, epoch 94, cost  -1.31292999423
Pre-training layer 2, epoch 95, cost  -1.30902794875
Pre-training layer 2, epoch 96, cost  -1.30613053424
Pre-training layer 2, epoch 97, cost  -1.30968961274
Pre-training layer 2, epoch 98, cost  -1.3041734887
Pre-training layer 2, epoch 99, cost  -1.30933243126
... getting the finetuning functions
The pretraining code for file dbn_try1.py ran for 61.68m
... finetunning the model
epoch 1, minibatch 200/200, validation error 50.166667 %
     epoch 1, minibatch 200/200, test error of best model 52.909091 %
epoch 2, minibatch 200/200, validation error 50.166667 %
epoch 3, minibatch 200/200, validation error 50.166667 %
epoch 4, minibatch 200/200, validation error 50.166667 %
Optimization complete with best validation score of 50.166667 %,with test performance 52.909091 %
The fine tuning code for file dbn_try1.py ran for 1.17m